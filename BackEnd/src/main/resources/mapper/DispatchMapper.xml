<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dasi.core.mapper.DispatchMapper">

    <select id="selectMailboxInfo" resultType="com.dasi.pojo.entity.Mailbox">
        SELECT
            c.inbox                       AS inbox,
            a.name                        AS addresser,
            m.subject                     AS subject,
            m.content                     AS content,
            m.attachments                 AS attachments,
            0                             AS is_read,
            0                             AS is_deleted,
            NOW()                         AS arrivedAt,
            NULL                          AS readAt
        FROM dispatch d
        JOIN message m ON d.msg_id = m.id
        LEFT JOIN account a ON d.send_from = a.id
        LEFT JOIN contact c ON d.send_to = c.id
        WHERE d.id = #{dispatchId}
        LIMIT 1
    </select>

</mapper>